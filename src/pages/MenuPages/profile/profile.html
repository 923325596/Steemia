<ion-header [class.opaque]="showToolbar" no-lines>
  <ion-navbar transparent>
    <ion-title>
      <ion-badge color="gray">{{ account_data?.username }}</ion-badge>
      <ion-badge color="light">{{ account_data?.reputation }}</ion-badge>
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content (ionScroll)="onScroll($event)">

  <div class="card-profile">
    <div class="card-profile_visual"></div>
    <div class="card-profile_user-infos">
      <span class="info_picture">
        <img [src]="render_image()" class="picture" />
      </span>
      <span class="infos_name">
        <ion-badge tappable (tap)="presentProfileModal()">
          <ion-icon tappable (tap)="presentProfileModal()" name="ios-create"></ion-icon> {{ 'pages.profile.edit_profile' | translate }}</ion-badge>
      </span>
      <span class="infos_nick">
        <span class="joined-date">
          {{ 'pages.profile.joined' | translate }}: {{ account_data?.created | amTimeAgo }}
        </span> |
        <span class="joined-date">
          {{ 'pages.profile.account_value' | translate }}: $ {{ account_data?.estimated_balance}}
        </span>

        <!-- {{ account_data?.about }} -->
      </span>

    </div>

    <div class="card-profile_user-stats">
      <ion-segment [(ngModel)]="sections" mode="md" (ionChange)="segmentChanged()">
        <ion-segment-button icon-top value="blog">
          <ion-icon name="paper"></ion-icon>
          <div style="margin-top: -35px;">
            <p>{{ 'pages.profile.posts' | translate }}</p>
          </div>
        </ion-segment-button>
        <ion-segment-button icon-top value="activity">
          <ion-icon name="analytics"></ion-icon>
          <div style="margin-top: -35px;">
            <p>{{ 'pages.profile.activity' | translate }}</p>
          </div>
        </ion-segment-button>
        <ion-segment-button icon-top value="about">
          <ion-icon name="person"></ion-icon>
          <div style="margin-top: -35px;">
            <p>{{ 'pages.profile.info' | translate }}</p>
          </div>
        </ion-segment-button>
        <ion-segment-button icon-top value="wallet">
          <ion-icon name="card"></ion-icon>
          <div style="margin-top: -35px;">
            <p>{{ 'pages.profile.wallet' | translate }}</p>
          </div>
        </ion-segment-button>
      </ion-segment>

    </div>

    <div [ngSwitch]="sections" class="custom-width">
      <div *ngSwitchCase="'blog'">

        <ion-spinner *ngIf="is_loading"></ion-spinner>
        
        <div *ngIf="!is_loading">
          <div *ngFor="let content of contents; trackBy: trackById">
            <post-card [post]="content" [from]="'PROFILE'" [user]="username"></post-card>
          </div>
        </div>

        <no-data *ngIf="no_post == true" icon="chatbubbles" title="This user has not posts, YET!">
        </no-data>

        <div *ngIf="is_more_post == false">
          <p text-center>{{ 'generic_messages.not_more_posts' | translate }}</p>
        </div>

        <ion-infinite-scroll *ngIf="contents.length >= 1 && is_more_post == true" (ionInfinite)="doInfinite($event)" distance="1%">
          <ion-infinite-scroll-content></ion-infinite-scroll-content>
        </ion-infinite-scroll>
      </div>
      <div *ngSwitchCase="'activity'">
        <ion-card>
          <ion-card-content text-center>
            <img src="assets/img1.png" />
            <p>{{ 'generic_messages.working_feature' | translate }}</p>
          </ion-card-content>
        </ion-card>
      </div>
      <div *ngSwitchCase="'about'">
        <ion-list no-lines>
          <ion-item no-lines tappable (click)="open_followers();">
            <ion-icon name="people" item-start></ion-icon>
            {{ 'pages.profile.followers' | translate }}
            <ion-badge color="light" item-end>{{ stats?.followers_count }}</ion-badge>
          </ion-item>
          <ion-item no-lines tappable (click)="open_following();">
            <ion-icon name="person-add" item-start></ion-icon>
            {{ 'pages.profile.following' | translate }}
            <ion-badge color="light" item-end>{{ stats?.following_count }}</ion-badge>
          </ion-item>
          <ion-item no-lines>
            <ion-icon name="paper" item-start></ion-icon>
            {{ 'pages.profile.posts' | translate }}
            <ion-badge color="light" item-end>{{ account_data?.post_count }}</ion-badge>
          </ion-item>
          <ion-item no-lines>
            <ion-icon name="pin" item-start></ion-icon>
            {{ 'pages.profile.location' | translate }}
            <ion-badge color="light" item-end>{{ account_data?.location }}</ion-badge>
          </ion-item>
          <ion-item no-lines>
            <ion-icon name="globe" item-start></ion-icon>
            {{ 'pages.profile.website' | translate }}
            <ion-badge color="light" item-end>{{ account_data?.website }}</ion-badge>
          </ion-item>
          <ion-item *ngIf='account_data?.json_metadata?.profile.facebook'>
            <ion-icon name="logo-facebook" item-start></ion-icon>
            Facebook
            <ion-badge color="light" item-end> @{{ account_data?.json_metadata?.profile.facebook }} </ion-badge>
          </ion-item>
          <ion-item>
            <ion-icon name="logo-github" item-start></ion-icon>
            Github
            <ion-badge color="light" item-end> @{{ account_data?.json_metadata?.profile.github }} </ion-badge>
          </ion-item>
          <ion-item>
            <ion-icon name="logo-twitter" item-start></ion-icon>
            Twitter
            <ion-badge color="light" item-end> @{{ account_data?.json_metadata?.profile.twitter }} </ion-badge>
          </ion-item>
          <ion-item>
            <ion-icon name="logo-instagram" item-start></ion-icon>
            Instagram
            <ion-badge color="light" item-end> @{{ account_data?.json_metadata?.profile.instagram }} </ion-badge>
          </ion-item>
          <ion-item>
            <ion-icon name="logo-youtube" item-start></ion-icon>
            Youtube
            <ion-badge color="light" item-end> @{{ account_data?.json_metadata?.profile.youtube }} </ion-badge>
          </ion-item>
        </ion-list>
      </div>
      <div *ngSwitchCase="'wallet'">
        <ion-list no-lines>
          <ion-item no-lines>
            <ion-avatar item-start>
              <img src="assets/steem.png">
            </ion-avatar>
            <h2>STEEM</h2>
            <p>{{ account_data?.balance }}</p>
          </ion-item>
          <ion-item no-lines>
            <ion-avatar item-start>
              <img src="assets/steem.png">
            </ion-avatar>
            <h2>SBD</h2>
            <p>{{ account_data?.sbd_balance }}</p>
          </ion-item>
          <ion-item no-lines>
            <ion-avatar item-start>
              <img src="assets/steem.png">
            </ion-avatar>
            <h2>STEEM POWER</h2>
            <p>{{ voting_power }} SP <span *ngIf='account_data?.exact_delegation != 0'>({{ account_data?.exact_delegation }} Delegated SP)</span> </p>
          </ion-item>
          <ion-item no-lines>
            <ion-avatar item-start>
              <img src="assets/steem.png">
            </ion-avatar>
            <h2>Saving Balance</h2>
            <p>{{ account_data?.savings_balance }}</p>
            <p>{{ account_data?.savings_sbd_balance }}</p>
          </ion-item>
        </ion-list>
      </div>
    </div>
  </div>
</ion-content>